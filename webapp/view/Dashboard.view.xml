<mvc:View
    controllerName="sap.vic.dashboard.controller.Dashboard"
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.f"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:viz.data="sap.viz.ui5.data"
    xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds"
    xmlns:core="sap.ui.core">
<f:DynamicPage id="dynamicPageId"
                   headerExpanded="{state>/headerExpanded}">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="VIC Dashboard"/>
                </f:heading>
            </f:DynamicPageTitle>
        </f:title>
        <f:header>
            <f:DynamicPageHeader>
                <f:content>
                    <fb:FilterBar id="filterbar" useToolbar="false" search="onPressGo" showGoOnFB="true" showClearOnFB="true" clear="onFilterBarClear">
                        <fb:filterGroupItems>
                            <fb:FilterGroupItem groupName="primary" name="testType" label="Test Type" visibleInFilterBar="true">
                                <fb:control>
                                    <MultiComboBox id="testTypeSelect" items="{mock>/TestTypes}" selectedKeys="{mock>/Selections/TestType}" selectionChange="onMultiChange" width="220px">
                                        <core:Item key="{mock>key}" text="{mock>text}" />
                                    </MultiComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>
                            <fb:FilterGroupItem groupName="primary" name="productArea" label="Product Area" visibleInFilterBar="true">
                                <fb:control>
                                    <MultiComboBox id="productAreaSelect" items="{mock>/ProductAreas}" selectedKeys="{mock>/Selections/ProductArea}" selectionChange="onMultiChange" width="220px">
                                        <core:Item key="{mock>key}" text="{mock>text}" />
                                    </MultiComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="primary" name="testPlan" label="Test Plan" visibleInFilterBar="true">
                                <fb:control>
                                    <MultiComboBox id="testPlanSelect" enabled="true" items="{mock>/TestPlans}" selectedKeys="{mock>/Selections/TestPlan}" selectionChange="onMultiChange" width="260px">
                                        <core:Item key="{mock>key}" text="{mock>text}" />
                                    </MultiComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="primary" name="similarity" label="Similarity" visibleInFilterBar="true">
                                <fb:control>
                                    <MultiComboBox id="similaritySelect" selectedKeys="{mock>/Selections/Similarity}" selectionChange="onMultiChange" width="200px">
                                        <core:Item key="ALL" text="Select All" />
                                        <core:Item key="lt96" text="Less than 96%" />
                                        <core:Item key="lt97" text="Less than 97%" />
                                        <core:Item key="lt98" text="Less than 98%" />
                                        <core:Item key="lt99" text="Less than 99%" />
                                        <core:Item key="lt100" text="Less than 100%" />
                                    </MultiComboBox>
                                </fb:control>
                            </fb:FilterGroupItem>

                            <fb:FilterGroupItem groupName="primary" name="date" label="Date" visibleInFilterBar="true">
                                <fb:control>
                                    <DateRangeSelection id="dateRange" change="onFilterBarChange"/>
                                </fb:control>
                            </fb:FilterGroupItem>
                        </fb:filterGroupItems>
                    </fb:FilterBar>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <VBox class="sapUiContentPadding" fitContainer="true">
                <OverflowToolbar>
                    <ToolbarSpacer/>
                    <SegmentedButton id="viewSwitch" selectedKey="{view>/view}" selectionChange="onViewChange">
                        <items>
                            <SegmentedButtonItem text="Chart View" key="chart" icon="sap-icon://bar-chart" tooltip="Switch to Chart View"/>
                            <SegmentedButtonItem text="Table View" key="table" icon="sap-icon://table-view" tooltip="Switch to Table View"/>
                        </items>
                    </SegmentedButton>
                    <ToolbarSeparator/>
                    <Label text="Live" visible="false"/>
                    <Switch id="switchLive" state="{state>/liveMode}" change="onToggleLive" visible="false" />
                    <ToolbarSeparator/>
                    <Select id="chartTypeSelect" selectedKey="{state>/chartType}" change="onChartTypeChange" width="200px">
                        <items>
                            <core:Item key="pie" text="Pie"/>
                            <core:Item key="donut" text="Donut"/>
                            <core:Item key="column" text="Column"/>
                            <core:Item key="bar" text="Bar"/>
                            <core:Item key="line" text="Line"/>
                            <core:Item key="stacked_column" text="Stacked Column"/>
                            <core:Item key="stacked_bar" text="Stacked Bar"/>
                        </items>
                    </Select>
                    <Button id="btnExecute" text="Execute" type="Emphasized" enabled="false" tooltip="Requires Authorization from VIC team to activate" press="onExecute" />
                </OverflowToolbar>
            <viz:Popover id="idPopOver"></viz:Popover>
            <VBox visible="{= ${view>/view} === 'chart' }" class="sapUiSmallMarginTop">
                <viz:VizFrame id="mainViz"
                              uiConfig="{applicationSet:'fiori'}"
                              height="420px"
                              width="100%"
                              vizType="{state>/chartType}"
                              selectData="onChartSelect">
                    <viz:dataset>
                        <viz.data:FlattenedDataset data="{mock>/ChartData}">
                            <viz.data:dimensions>
                                <viz.data:DimensionDefinition name="ProductArea" value="{ProductArea}" />
                            </viz.data:dimensions>
                            <viz.data:measures>
                                <viz.data:MeasureDefinition name="Sim100" value="{Sim100}" />
                                <viz.data:MeasureDefinition name="Sim99" value="{Sim99}" />
                                <viz.data:MeasureDefinition name="SimLess" value="{SimLess}" />
                            </viz.data:measures>
                        </viz.data:FlattenedDataset>
                    </viz:dataset>
                </viz:VizFrame>
            </VBox>
            <Table
                id="tableView"
                visible="{= ${view>/view} === 'table' }"
                items="{mock>/ChartData}"
                class="sapUiResponsiveMargin"
                width="auto"
                itemPress="onRowPress">
                <headerToolbar>
                    <Toolbar>
                        <Title text="Data"/>
                        <ToolbarSpacer />
                        <Button id="btnTableSettings" text="Settings" icon="sap-icon://action-settings" press="onOpenColumnSettings" class="sapUiTinyMarginEnd" />
                        <Button id="btnTableExport" text="Export Excel" icon="sap-icon://excel-attachment" press="onExport" />
                    </Toolbar>
                </headerToolbar>
                <columns>
                    <Column><Text text="Product Area" /></Column>
                    <Column hAlign="End"><Text text="Sim 100" /></Column>
                    <Column hAlign="End"><Text text="Sim 99" /></Column>
                    <Column hAlign="End"><Text text="Sim Less" /></Column>
                </columns>
                <items>
                    <ColumnListItem type="Navigation">
                        <cells>
                            <Text text="{mock>ProductArea}" />
                            <ObjectNumber number="{mock>Sim100}" />
                            <ObjectNumber number="{mock>Sim99}" />
                            <ObjectNumber number="{mock>SimLess}" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>
